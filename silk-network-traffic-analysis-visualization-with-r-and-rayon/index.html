<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>SiLK Network Traffic Analysis Visualization with R and Rayon - Stephen Reese</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index,follow" />
<link rel="canonical" href="/silk-network-traffic-analysis-visualization-with-r-and-rayon/">
        <meta name="author" content="Stephen Reese" />
        <meta name="keywords" content="silk,graph,R" />
        <meta name="description" content="In this post, the process for retroactively identifying and graphing a HTTPS DDoS of service condition is described. Why do we care about graphing, because it can be a great way to describe data to folks that may not be interested in looking at it in a tabular form, e …" />
    <!-- Bootstrap -->
    <link rel="stylesheet" href="/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="/theme/css/pygments/default.css" rel="stylesheet">
    <link href="/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>
    <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Stephen Reese ATOM Feed"/>
</head>
<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">
rsreese.com            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/archives/">Archives</a></li>
                         <li><a href="/about/">
                             About
                          </a></li>
                         <li><a href="/contact/">
                             Contact
                          </a></li>
                         <li><a href="/web-stack/">
                             Web&nbsp;Stack
                          </a></li>
            </ul>
        </div>
    </div>
</div> 

<div id="site-banner">
        <div id="site-banner-brand">
            <div>
                <a href="/"><h1 class="center-block">Stephen Reese</h1></a>
            </div>

                <div id="social-banner">
                    <ul class="list-group list-inline">
                            <li class="list-group-item">
                                <a class="navbar-link social-nav-link" href="/contact/"><i class="fa fa-envelope fa-lg"></i></a>
                            </li>
                            <li class="list-group-item">
                                <a class="navbar-link social-nav-link" href="https://github.com/rsreese"><i class="fa fa-github fa-lg"></i></a>
                            </li>
                            <li class="list-group-item">
                                <a class="navbar-link social-nav-link" href="https://twitter.com/rsreese"><i class="fa fa-twitter fa-lg"></i></a>
                            </li>
                            <li class="list-group-item">
                                <a class="navbar-link social-nav-link" href="https://www.google.com/profiles/rsreese"><i class="fa fa-google-plus fa-lg"></i></a>
                            </li>
                            <li class="list-group-item">
                                <a class="navbar-link social-nav-link" href="https://facebook.com/rsreese"><i class="fa fa-facebook fa-lg"></i></a>
                            </li>
                            <li class="list-group-item">
                                <a class="navbar-link social-nav-link" href="https://www.linkedin.com/in/rsreese"><i class="fa fa-linkedin fa-lg"></i></a>
                            </li>
                            <li class="list-group-item">
                                <a class="navbar-link social-nav-link" href="https://feeds.feedburner.com/rsreese"><i class="fa fa-rss fa-lg"></i></a>
                            </li>
                    </ul>
                </div>

        </div>
    </div>

<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/silk-network-traffic-analysis-visualization-with-r-and-rayon/"
                       rel="bookmark"
                       title="Permalink to SiLK Network Traffic Analysis Visualization with R and Rayon">
                        SiLK Network Traffic Analysis Visualization with R and&nbsp;Rayon
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
            <span>By</span>
            <a href="/author/stephen-reese.html">Stephen Reese</a>

    <span>on</span>
    <span class="published">
        <time datetime="2015-11-07T12:00:00-05:00"> Sat 07 November 2015</time>
    </span>

        <span><a href="/categories/">Category</a>:</span>
        <a href="/category/coding/">coding</a>


<span><a href="/tags/">Tags:</a></span>
	<a href="/tag/silk/">silk</a>
        /
	<a href="/tag/graph/">graph</a>
        /
	<a href="/tag/r/">R</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>In this post, the process for retroactively identifying and graphing a <span class="caps">HTTPS</span> DDoS of service condition is described. Why do we care about graphing, because it can be a great way to describe data to folks that may not be interested in looking at it in a tabular form, e.g. leadership. The specific example will use data collected from the server this blog is hosted on. If you are following along, this post assumes you have SiLK deployed in some manner and are collecting <span class="caps">HTTP</span> or similar traffic. Technically a DDoS condition did not occur (only two hosts were making a large number of requests) but blitz.io was used to exceed the network traffic this website typically experiences for sake of example. If a true DoS condition occurred, it would appear differently as the sensor is hosted on the same node therefore it would not record the surge in traffic. In order to record a true DoS, the sensor would ideally be placed upstream in the carrier or somewhere that exceeds the devices being monitored capacity. I would like to thank network defense analyst <a href="https://www.linkedin.com/profile/view?id=ADEAAADy7VgB1LVykcDh0APWz0yz_ROaSvn-V4A">Geoffrey Sanders</a> for providing R langauge as well as statistical recommendations in order to improve data analysis and graphical&nbsp;representations.</p>
<p>If we would like to retroactively search for anomaly in traffic volume, we can query a number of days and look for unusual&nbsp;spikes:</p>
<div class="highlight"><pre><span></span>for DAY in {1..31}; do
    if [ <span class="cp">${</span><span class="n">DAY</span><span class="cp">}</span> -le 9 ]; then
        DAY=0<span class="cp">${</span><span class="n">DAY</span><span class="cp">}</span>
    fi

    RESULT=$(rwfilter --start-date=2015/07/<span class="cp">${</span><span class="n">DAY</span><span class="cp">}</span> --end-date=2015/07/<span class="cp">${</span><span class="n">DAY</span><span class="cp">}</span> --dport=443 --pass=stdout --type=all|rwuniq --fields=dport,proto -
-values=records --no-col --no-final-del --no-title --packets=20-)

    echo &quot;2015/07/<span class="cp">${</span><span class="n">DAY</span><span class="cp">}</span>|<span class="cp">${</span><span class="n">RESULT</span><span class="cp">}</span>&quot; &gt;&gt; http.out

done
</pre></div>


<p>On the 21st, we see a large number of requests that significantly exceed other&nbsp;days:</p>
<div class="highlight"><pre><span></span>2015/07/01|443|6|1443|33287
2015/07/02|443|6|1271|30583
2015/07/03|443|6|1776|32622
2015/07/04|443|6|1498|28316
2015/07/05|443|6|1124|34428
2015/07/06|443|6|1672|36113
2015/07/07|443|6|1298|31087
2015/07/08|443|6|1629|40990
2015/07/09|443|6|42005|750922
2015/07/10|443|6|1656|54450
2015/07/11|443|6|1464|40205
2015/07/12|443|6|1279|22251
2015/07/13|443|6|1884|40887
2015/07/14|443|6|1724|49821
2015/07/15|443|6|1635|37133
2015/07/16|443|6|1653|33433
2015/07/17|443|6|1695|37580
2015/07/18|443|6|1301|24899
2015/07/19|443|6|1445|29230
2015/07/20|443|6|1314|40543
2015/07/21|443|6|70533|817855
2015/07/22|443|6|1909|42257
2015/07/23|443|6|1462|47961
2015/07/24|443|6|1705|37581
2015/07/25|443|6|1150|27093
2015/07/26|443|6|1208|21267
2015/07/27|443|6|1597|32414
2015/07/28|443|6|1714|45208
2015/07/29|443|6|1702|35607
2015/07/30|443|6|1710|46748
2015/07/31|443|6|1514|47915
</pre></div>


<p>We can use a similar query broken down by hour for the questionable&nbsp;day:</p>
<div class="highlight"><pre><span></span>for HOUR in {0..23}; do if [ <span class="cp">${</span><span class="n">HOUR</span><span class="cp">}</span> -le 9 ]; then
        HOUR=0<span class="cp">${</span><span class="n">HOUR</span><span class="cp">}</span>
    fi

    RESULT=$(rwfilter --start-date=2015/07/21:<span class="cp">${</span><span class="n">HOUR</span><span class="cp">}</span> --end-date=2015/07/21:<span class="cp">${</span><span class="n">HOUR</span><span class="cp">}</span> --dport=443 --pass=stdout --type=all|rwuniq --fields=dport
,proto --values=records --no-col --no-final-del --no-title --packets=20-)

    echo &quot;<span class="cp">${</span><span class="n">HOUR</span><span class="cp">}</span>|<span class="cp">${</span><span class="n">RESULT</span><span class="cp">}</span>&quot; &gt;&gt; http-hour.out

done
</pre></div>


<p>The results from the hourly query clearly depict when the surge of <span class="caps">HTTPS</span> traffic volume occurred. From here, an analyst may run more specific queries to determine if it is indeed a distributed attack or sourced from only a few&nbsp;nodes.</p>
<div class="highlight"><pre><span></span>00|443|6|72|1392
01|443|6|48|3203
02|443|6|151|2605
03|443|6|173|1612
04|443|6|125|2318
05|443|6|149|2622
06|443|6|72|1450
07|443|6|71|1294
08|443|6|73|1524
09|443|6|76|1881
10|443|6|67|1412
11|443|6|823|6720
12|443|6|60|1639
13|443|6|65|1511
14|443|6|72|2987
15|443|6|121|2061
16|443|6|69|2135
17|443|6|67562|722727
18|443|6|203|3222
19|443|6|112|4004
20|443|6|99|1526
21|443|6|122|44746
22|443|6|94|2129
23|443|6|54|1135
</pre></div>


<p>We can represent the tabular data from the daily and hourly queries using <a href="http://www.r-project.org">R Project</a> and ggplot2. For the daily plot example, add a header <code>day|dPort|protocol|Records|Packets</code> to the dataset and run <code>Rscript filename.r dataset.dat</code> replacing the command directives with the script below and your&nbsp;dataset:</p>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>reshape2<span class="p">)</span>

<span class="kp">options</span><span class="p">(</span><span class="s">&quot;scipen&quot;</span><span class="o">=</span><span class="m">100</span><span class="p">,</span> <span class="s">&quot;digits&quot;</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
fname <span class="o">&lt;-</span> <span class="kp">commandArgs</span><span class="p">(</span>trailingOnly <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span>
flowrecs <span class="o">&lt;-</span> read.table<span class="p">(</span>fname<span class="p">,</span> header <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;|&quot;</span><span class="p">)</span>
flowrecs<span class="o">$</span>day <span class="o">&lt;-</span> <span class="kp">as.Date</span><span class="p">(</span>flowrecs<span class="o">$</span>day<span class="p">,</span> <span class="s">&quot;%Y/%m/%d&quot;</span><span class="p">)</span>
test_data_long <span class="o">&lt;-</span> melt<span class="p">(</span>flowrecs<span class="p">,</span> id.vars<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;day&quot;</span><span class="p">,</span> <span class="s">&quot;dPort&quot;</span><span class="p">,</span> <span class="s">&quot;protocol&quot;</span><span class="p">))</span>

flow.plot <span class="o">&lt;-</span> ggplot<span class="p">(</span>data<span class="o">=</span>test_data_long<span class="p">,</span>
    aes<span class="p">(</span>x<span class="o">=</span>day<span class="p">,</span> y<span class="o">=</span>value<span class="p">,</span> colour<span class="o">=</span>variable<span class="p">))</span> 
    geom_line<span class="p">()</span> <span class="o">+</span> geom_point<span class="p">()</span> <span class="o">+</span> xlab<span class="p">(</span><span class="s">&quot;Day&quot;</span><span class="p">)</span> <span class="o">+</span> ylab<span class="p">(</span><span class="s">&quot;Flow Records with 20+ Packets&quot;</span><span class="p">)</span> 
    ggtitle<span class="p">(</span><span class="kp">paste</span><span class="p">(</span><span class="s">&quot;Flow Records by Destination Port&quot;</span><span class="p">))</span>

png<span class="p">(</span><span class="s">&quot;plot.png&quot;</span><span class="p">,</span> width<span class="o">=</span><span class="m">1200</span><span class="p">,</span> height<span class="o">=</span><span class="m">400</span><span class="p">)</span>
plot<span class="p">(</span>flow.plot<span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>


<p>Which should provide a graphical representation similar&nbsp;to:</p>
<p><a href="/assets/daily-https-plot.png"><img alt="daily-https-plot" src="/assets/daily-https-plot.png"></a></p>
<p>Similarly, we can do the same thing with the hourly plot by specifying the correct header of <code>hour|dPort|protocol|Records|Packets</code> and rerunning <code>Rscript</code> in the same manner as the daily&nbsp;plot.</p>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>reshape2<span class="p">)</span>

<span class="kp">options</span><span class="p">(</span><span class="s">&quot;scipen&quot;</span><span class="o">=</span><span class="m">100</span><span class="p">,</span> <span class="s">&quot;digits&quot;</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
fname <span class="o">&lt;-</span> <span class="kp">commandArgs</span><span class="p">(</span>trailingOnly <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span>
flowrecs <span class="o">&lt;-</span> read.table<span class="p">(</span>fname<span class="p">,</span> header <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;|&quot;</span><span class="p">)</span>
flowrecs<span class="o">$</span>hour <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span>flowrecs<span class="o">$</span>hour<span class="p">,</span> levels<span class="o">=</span><span class="kp">unique</span><span class="p">(</span>flowrecs<span class="o">$</span>hour<span class="p">))</span>
test_data_long <span class="o">&lt;-</span> melt<span class="p">(</span>flowrecs<span class="p">,</span> id.var<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;hour&quot;</span><span class="p">,</span> <span class="s">&quot;dPort&quot;</span><span class="p">,</span> <span class="s">&quot;protocol&quot;</span><span class="p">))</span>

flow.plot <span class="o">&lt;-</span> ggplot<span class="p">(</span>data<span class="o">=</span>test_data_long<span class="p">,</span>
    aes<span class="p">(</span>x<span class="o">=</span>hour<span class="p">,</span> y<span class="o">=</span>value<span class="p">,</span> colour<span class="o">=</span>variable<span class="p">,</span> group<span class="o">=</span>variable<span class="p">))</span> <span class="o">+</span> 
    geom_line<span class="p">()</span> <span class="o">+</span> geom_point<span class="p">()</span> <span class="o">+</span> xlab<span class="p">(</span><span class="s">&quot;Hour&quot;</span><span class="p">)</span> <span class="o">+</span> ylab<span class="p">(</span><span class="s">&quot;Flow Records with 20+ Packets&quot;</span><span class="p">)</span> 
    ggtitle<span class="p">(</span><span class="kp">paste</span><span class="p">(</span><span class="s">&quot;Flow Records by Destination Port&quot;</span><span class="p">))</span>

png<span class="p">(</span><span class="s">&quot;plot.png&quot;</span><span class="p">,</span> width<span class="o">=</span><span class="m">1200</span><span class="p">,</span> height<span class="o">=</span><span class="m">400</span><span class="p">)</span>
plot<span class="p">(</span>flow.plot<span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>


<p>This depicts the two large sets of requests we had in the single&nbsp;day:</p>
<p><a href="/assets/hourly-https-plot.png"><img alt="hourly-https-plot" src="/assets/hourly-https-plot.png"></a></p>
<p>We can use <code>rwstats</code> in order to take a look at our top talkers if we are aware of congestion or other signs that the uniformity of visitors has changed. This query is a little artificial though. It is very possible that the source attacks may come from hundreds or even thousands of bots or some reflection mechanism depending on the service. If that is the case, we may have to look at other tuples or the actual request in order to determine a similarity between the distributed attack&nbsp;sources.</p>
<div class="highlight"><pre><span></span>$ rwfilter --start-date<span class="o">=</span><span class="m">2015</span>/7/21 --end-date<span class="o">=</span><span class="m">2015</span>/7/21 --dport<span class="o">=</span><span class="m">443</span> --pass<span class="o">=</span>stdout --type<span class="o">=</span>all<span class="p">|</span>rwstats --fields<span class="o">=</span>sip --count<span class="o">=</span><span class="m">10</span> --no-col --no-final-del
INPUT: <span class="m">70533</span> Records <span class="k">for</span> <span class="m">551</span> Bins and <span class="m">70533</span> Total Records
OUTPUT: Top <span class="m">10</span> Bins by Records
sIP<span class="p">|</span>Records<span class="p">|</span>%Records<span class="p">|</span>cumul_%
<span class="m">54</span>.173.173.209<span class="p">|</span><span class="m">33704</span><span class="p">|</span><span class="m">47</span>.784725<span class="p">|</span><span class="m">47</span>.784725
<span class="m">54</span>.86.98.210<span class="p">|</span><span class="m">33698</span><span class="p">|</span><span class="m">47</span>.776218<span class="p">|</span><span class="m">95</span>.560943
<span class="m">162</span>.243.196.54<span class="p">|</span><span class="m">742</span><span class="p">|</span><span class="m">1</span>.051990<span class="p">|</span><span class="m">96</span>.612933
<span class="m">180</span>.76.15.142<span class="p">|</span><span class="m">97</span><span class="p">|</span><span class="m">0</span>.137524<span class="p">|</span><span class="m">96</span>.750457
<span class="m">68</span>.180.230.230<span class="p">|</span><span class="m">75</span><span class="p">|</span><span class="m">0</span>.106333<span class="p">|</span><span class="m">96</span>.856790
<span class="m">180</span>.76.15.140<span class="p">|</span><span class="m">37</span><span class="p">|</span><span class="m">0</span>.052458<span class="p">|</span><span class="m">96</span>.909248
<span class="m">72</span>.80.60.139<span class="p">|</span><span class="m">31</span><span class="p">|</span><span class="m">0</span>.043951<span class="p">|</span><span class="m">96</span>.953199
<span class="m">66</span>.249.67.118<span class="p">|</span><span class="m">31</span><span class="p">|</span><span class="m">0</span>.043951<span class="p">|</span><span class="m">96</span>.997150
<span class="m">180</span>.76.15.136<span class="p">|</span><span class="m">24</span><span class="p">|</span><span class="m">0</span>.034027<span class="p">|</span><span class="m">97</span>.031177
<span class="m">63</span>.254.26.10<span class="p">|</span><span class="m">23</span><span class="p">|</span><span class="m">0</span>.032609<span class="p">|</span><span class="m">97</span>.063786
</pre></div>


<p>We can append <code>rwresolve</code> in order resolve a specific <span class="caps">IP</span> field. We see two Amazon hosts whom are likely the Blitz.io bots as they comprise 96% of the traffic for the defined time&nbsp;threshold:</p>
<div class="highlight"><pre><span></span>$ rwfilter --start-date<span class="o">=</span><span class="m">2015</span>/7/21 --end-date<span class="o">=</span><span class="m">2015</span>/7/21 --dport<span class="o">=</span><span class="m">443</span> --pass<span class="o">=</span>stdout --type<span class="o">=</span>all<span class="p">|</span>rwstats --fields<span class="o">=</span>sip --count<span class="o">=</span><span class="m">10</span> --no-col --no-final-del<span class="p">|</span>rwresolve --ip-fields<span class="o">=</span><span class="m">1</span>
INPUT: <span class="m">70533</span> Records <span class="k">for</span> <span class="m">551</span> Bins and <span class="m">70533</span> Total Records
OUTPUT: Top <span class="m">10</span> Bins by Records
sIP<span class="p">|</span>Records<span class="p">|</span>%Records<span class="p">|</span>cumul_%
ec2-54-173-173-209.compute-1.amazonaws.com<span class="p">|</span><span class="m">33704</span><span class="p">|</span><span class="m">47</span>.784725<span class="p">|</span><span class="m">47</span>.784725
ec2-54-86-98-210.compute-1.amazonaws.com<span class="p">|</span><span class="m">33698</span><span class="p">|</span><span class="m">47</span>.776218<span class="p">|</span><span class="m">95</span>.560943
<span class="m">162</span>.243.196.54<span class="p">|</span><span class="m">742</span><span class="p">|</span><span class="m">1</span>.051990<span class="p">|</span><span class="m">96</span>.612933
baiduspider-180-76-15-142.crawl.baidu.com<span class="p">|</span><span class="m">97</span><span class="p">|</span><span class="m">0</span>.137524<span class="p">|</span><span class="m">96</span>.750457
b115504.yse.yahoo.net<span class="p">|</span><span class="m">75</span><span class="p">|</span><span class="m">0</span>.106333<span class="p">|</span><span class="m">96</span>.856790
baiduspider-180-76-15-140.crawl.baidu.com<span class="p">|</span><span class="m">37</span><span class="p">|</span><span class="m">0</span>.052458<span class="p">|</span><span class="m">96</span>.909248
pool-72-80-60-139.nycmny.fios.verizon.net<span class="p">|</span><span class="m">31</span><span class="p">|</span><span class="m">0</span>.043951<span class="p">|</span><span class="m">96</span>.953199
crawl-66-249-67-118.googlebot.com<span class="p">|</span><span class="m">31</span><span class="p">|</span><span class="m">0</span>.043951<span class="p">|</span><span class="m">96</span>.997150
baiduspider-180-76-15-136.crawl.baidu.com<span class="p">|</span><span class="m">24</span><span class="p">|</span><span class="m">0</span>.034027<span class="p">|</span><span class="m">97</span>.031177
mail.oswaldcompanies.com<span class="p">|</span><span class="m">23</span><span class="p">|</span><span class="m">0</span>.032609<span class="p">|</span><span class="m">97</span>.063786
</pre></div>


<p>Both of the graphs above describe the anomalous traffic but our normal traffic is no longer clear. One way we can provide a more clarification is to use statistics in order to more effectively describe the data because of the significant outliers. In order to achieve this, we will first use a <code>log</code> function in order to describe the data volumes. We use the same scripts as earlier, but change <code>y=value</code> to <code>y=log(value)</code>.</p>
<p><a href="/assets/daily-https-logplot.png"><img alt="daily-https-logplot" src="/assets/daily-https-logplot.png"></a></p>
<p><a href="/assets/hourly-https-logplot.png"><img alt="hourly-https-logplot" src="/assets/hourly-https-logplot.png"></a></p>
<p>While using a <code>log</code> function provided an improvement, it may not provide an accurate representation of volume data types. Next, we will take a look at percentiles with R. Our data frame is composed of three days. The middle being the 21st which contains our fictitious DoS&nbsp;attack.</p>
<div class="highlight"><pre><span></span>&gt; mydata
      [,1]   [,2] [,3]
 [1,] 1252   1392 1551
 [2,] 1347   3203 1969
 [3,]  749   2605 1642
 [4,] 2232   1612 1432
 [5,]  707   2318 1531
 [6,]  552   2622 1175
 [7,] 1072   1450 1981
 [8,]  487   1294 1606
 [9,] 1448   1524  959
[10,]  867   1881 1763
[11,]  903   1412 1283
[12,]  911   6720 3055
[13,] 1125   1639 3609
[14,] 1511   1511 1977
[15,] 1792   2987 2476
[16,]  912   2061 1722
[17,] 1114   2135  655
[18,]  424 722727 1338
[19,] 3888   3222 4038
[20,] 3646   4004 1765
[21,] 9281   1526 1650
[22,] 1590  44746 1190
[23,] 1131   2129 1190
[24,] 1602   1135  700
</pre></div>


<p>Here is how we get to our graph in the R&nbsp;console:</p>
<div class="highlight"><pre><span></span>mydata <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span>ncol<span class="o">=</span><span class="m">24</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">3</span><span class="p">)</span>
mydata <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span>df<span class="o">$</span>Packets<span class="p">,</span> ncol<span class="o">=</span><span class="m">3</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">24</span><span class="p">)</span>
dataout <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>mydata<span class="p">,</span> <span class="m">1</span><span class="p">,</span> quantile<span class="p">,</span> probs<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0.05</span><span class="p">,</span> <span class="m">0.5</span><span class="p">,</span> <span class="m">0.90</span><span class="p">))</span>
ylim<span class="o">=</span><span class="kp">range</span><span class="p">(</span><span class="m">500</span><span class="p">,</span><span class="m">5000</span><span class="p">)</span>
plot<span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>dataout<span class="p">)),</span> dataout<span class="p">[</span><span class="m">1</span><span class="p">,],</span> t<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> lty<span class="o">=</span><span class="m">2</span><span class="p">,</span> ylim<span class="o">=</span>ylim<span class="p">,</span> main<span class="o">=</span><span class="s">&quot;Flow Percentiles&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Hour&quot;</span><span class="p">,</span> 
ylab<span class="o">=</span><span class="s">&quot;Packets&quot;</span><span class="p">)</span> <span class="c1">#5%</span>
lines<span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>dataout<span class="p">)),</span> dataout<span class="p">[</span><span class="m">2</span><span class="p">,],</span> lty<span class="o">=</span><span class="m">1</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span> <span class="c1">#50%</span>
lines<span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>dataout<span class="p">)),</span> dataout<span class="p">[</span><span class="m">3</span><span class="p">,],</span> lty<span class="o">=</span><span class="m">2</span><span class="p">,</span> col<span class="o">=</span><span class="m">2</span><span class="p">)</span>  <span class="c1">#90%</span>
legend<span class="p">(</span><span class="s">&quot;topleft&quot;</span><span class="p">,</span> legend<span class="o">=</span><span class="kp">rev</span><span class="p">(</span><span class="kp">rownames</span><span class="p">(</span>dataout<span class="p">)),</span> lwd<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> col<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> lty<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
</pre></div>


<p><a href="/assets/hourly-https-quantileplot.png"><img alt="hourly-https-quantileplot" src="/assets/hourly-https-quantileplot.png"></a></p>
<p>The 90th percentile really stands out here but having to use <code>y</code> limit to see our lower percentiles prevents us from seeing the whole picture. Let us graph both again but splitting our lower and upper&nbsp;bounds.</p>
<div class="highlight"><pre><span></span>mydata <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span>ncol<span class="o">=</span><span class="m">24</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">3</span><span class="p">)</span>
mydata <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span>df<span class="o">$</span>Packets<span class="p">,</span> ncol<span class="o">=</span><span class="m">3</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">24</span><span class="p">)</span>
dataout <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>mydata<span class="p">,</span> <span class="m">1</span><span class="p">,</span> quantile<span class="p">,</span> probs<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span> <span class="m">0.05</span><span class="p">,</span> <span class="m">0.5</span><span class="p">))</span>
ylim<span class="o">=</span><span class="kp">range</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="m">4200</span><span class="p">)</span>
plot<span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>dataout<span class="p">)),</span> dataout<span class="p">[</span><span class="m">1</span><span class="p">,],</span> t<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> lty<span class="o">=</span><span class="m">2</span><span class="p">,</span> ylim<span class="o">=</span>ylim<span class="p">,</span> main<span class="o">=</span><span class="s">&quot;Flow Percentiles&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Hour&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;Packets&quot;</span><span class="p">)</span> <span class="c1">#1%</span>
lines<span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>dataout<span class="p">)),</span> dataout<span class="p">[</span><span class="m">2</span><span class="p">,],</span> lty<span class="o">=</span><span class="m">1</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span> <span class="c1">#5%</span>
lines<span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>dataout<span class="p">)),</span> dataout<span class="p">[</span><span class="m">3</span><span class="p">,],</span> lty<span class="o">=</span><span class="m">2</span><span class="p">,</span> col<span class="o">=</span><span class="m">2</span><span class="p">)</span>  <span class="c1">#50%</span>
legend<span class="p">(</span><span class="s">&quot;topleft&quot;</span><span class="p">,</span> legend<span class="o">=</span><span class="kp">rev</span><span class="p">(</span><span class="kp">rownames</span><span class="p">(</span>dataout<span class="p">)),</span> lwd<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> col<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> lty<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
</pre></div>


<p><a href="/assets/hourly-https-lowerplot.png"><img alt="hourly-https-lowerplot" src="/assets/hourly-https-lowerplot.png"></a></p>
<div class="highlight"><pre><span></span>mydata <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span>ncol<span class="o">=</span><span class="m">24</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">3</span><span class="p">)</span>
mydata <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span>df<span class="o">$</span>Packets<span class="p">,</span> ncol<span class="o">=</span><span class="m">3</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">24</span><span class="p">)</span>
dataout <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>mydata<span class="p">,</span> <span class="m">1</span><span class="p">,</span> quantile<span class="p">,</span> probs<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0.90</span><span class="p">,</span> <span class="m">0.95</span><span class="p">))</span>
ylim<span class="o">=</span><span class="kp">range</span><span class="p">(</span>dataout<span class="p">)</span>
plot<span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>dataout<span class="p">)),</span> dataout<span class="p">[</span><span class="m">1</span><span class="p">,],</span> t<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> lty<span class="o">=</span><span class="m">2</span><span class="p">,</span> ylim<span class="o">=</span>ylim<span class="p">,</span> main<span class="o">=</span><span class="s">&quot;Flow Percentiles&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Hour&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;Packets&quot;</span><span class="p">)</span> <span class="c1">#90%</span>
lines<span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>dataout<span class="p">)),</span> dataout<span class="p">[</span><span class="m">2</span><span class="p">,],</span> lty<span class="o">=</span><span class="m">1</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span> <span class="c1">#95%</span>
legend<span class="p">(</span><span class="s">&quot;topleft&quot;</span><span class="p">,</span> legend<span class="o">=</span><span class="kp">rev</span><span class="p">(</span><span class="kp">rownames</span><span class="p">(</span>dataout<span class="p">)),</span> lwd<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> col<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> lty<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
</pre></div>


<p><a href="/assets/hourly-https-upperplot.png"><img alt="hourly-https-upperplot" src="/assets/hourly-https-upperplot.png"></a></p>
<p>This is a better analytical view. We can infer that if we see traffic at the 90 percentile, likely something is off. For the heck of it, let us see how the percentiles compare to the mean and median, the former not being necessary as we already included it in the percentile two examples above but&nbsp;nevertheless.</p>
<div class="highlight"><pre><span></span>ylim<span class="o">=</span><span class="kp">range</span><span class="p">(</span><span class="m">500</span><span class="p">,</span><span class="m">5000</span><span class="p">)</span>
mydata <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span>ncol<span class="o">=</span><span class="m">24</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">3</span><span class="p">)</span>
mydata <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span>df<span class="o">$</span>Packets<span class="p">,</span> ncol<span class="o">=</span><span class="m">3</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">24</span><span class="p">)</span>
meandata <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>mydata<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="kp">mean</span><span class="p">)</span>
mediandata <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>mydata<span class="p">,</span> <span class="m">1</span><span class="p">,</span> median<span class="p">)</span>
plot<span class="p">(</span>meandata<span class="p">,</span> t<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> lty<span class="o">=</span><span class="m">2</span><span class="p">,</span> ylim<span class="o">=</span>ylim<span class="p">,</span> main<span class="o">=</span><span class="s">&quot;Flows&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Hour&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;Packets&quot;</span><span class="p">)</span>
lines<span class="p">(</span>mediandata<span class="p">,</span> lty<span class="o">=</span><span class="m">1</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span>
legend<span class="p">(</span><span class="s">&quot;topleft&quot;</span><span class="p">,</span> legend<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;Mean&quot;</span><span class="p">,</span> <span class="s">&quot;Median&quot;</span><span class="p">),</span> lwd<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">),</span> col<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> lty<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>


<p>The tabular data outliers are obvious but we will graph it. Based on this, we could leverage around 5 to 10 percentile for normal traffic but much larger sampling would need to take place as we only used three&nbsp;days.</p>
<div class="highlight"><pre><span></span>&gt; meandata
 [1]   1398.333   2173.000   1665.333   1758.667   1518.667   1449.667
 [7]   1501.000   1129.000   1310.333   1503.667   1199.333   3562.000
[13]   2124.333   1666.333   2418.333   1565.000   1301.333 241496.333
[19]   3716.000   3138.333   4152.333  15842.000   1483.333   1145.667
&gt; mediandata
 [1] 1392 1969 1642 1612 1531 1175 1450 1294 1448 1763 1283 3055 1639 1511 2476
[16] 1722 1114 1338 3888 3646 1650 1590 1190 1135
</pre></div>


<p><a href="/assets/hourly-https-meanplot.png"><img alt="hourly-https-meanplot" src="/assets/hourly-https-meanplot.png"></a></p>
<p>Last but not least, we are going to take a look at a tool the <a href="https://tools.netsa.cert.org/index.html">NetSA</a> team has developed for graphically representing data named <a href="https://tools.netsa.cert.org/rayon/index.html">Rayon</a>. I will provide a quick reference, but you can find more details <a href="https://resources.sei.cmu.edu/asset_files/Poster/2014_020_001_300465.pdf">here</a> and <a href="https://tools.netsa.cert.org/rayon/doc/man-rytimeseries.html">here</a>. As with R language, the outliers distort the graph so we use <code>log</code> functions for the second and third graphs in order to minimize the outlier effects. First, grab the data we are interested&nbsp;in:</p>
<div class="highlight"><pre><span></span>$ rwfilter --start-date<span class="o">=</span><span class="m">2015</span>/7/21 --end-date<span class="o">=</span><span class="m">2015</span>/7/21 --dport<span class="o">=</span><span class="m">443</span> --proto<span class="o">=</span><span class="m">6</span> --type<span class="o">=</span>inweb --pass<span class="o">=</span>httpsin.bin
$ rwfilter --start-date<span class="o">=</span><span class="m">2015</span>/7/21 --end-date<span class="o">=</span><span class="m">2015</span>/7/21 --dport<span class="o">=</span><span class="m">443</span> --proto<span class="o">=</span><span class="m">6</span> --type<span class="o">=</span>outweb --pass<span class="o">=</span>httpsout.bin
</pre></div>


<p>Next, export the values we need, we provide a snippet of our&nbsp;data:</p>
<div class="highlight"><pre><span></span>$ rwcount --bin-size<span class="o">=</span><span class="m">300</span> --no-titles --delimited httpsin.bin<span class="p">|</span>awk -F<span class="se">\|</span> <span class="s1">&#39;{printf(&quot;%s|%s|in\n&quot;, $1, $3)}&#39;</span> &gt; <span class="m">2</span>-top.txt
--snip--
<span class="m">2015</span>/07/21T00:00:00<span class="p">|</span><span class="m">5003</span>.00<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:05:00<span class="p">|</span><span class="m">16677</span>.47<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:10:00<span class="p">|</span><span class="m">4814</span>.53<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:15:00<span class="p">|</span><span class="m">4951</span>.00<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:20:00<span class="p">|</span><span class="m">1440</span>.00<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:25:00<span class="p">|</span><span class="m">10055</span>.00<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:30:00<span class="p">|</span><span class="m">5410</span>.06<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:35:00<span class="p">|</span><span class="m">1356</span>.94<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:40:00<span class="p">|</span><span class="m">4346</span>.32<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:45:00<span class="p">|</span><span class="m">10125</span>.04<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:50:00<span class="p">|</span><span class="m">7178</span>.64<span class="p">|</span>in
<span class="m">2015</span>/07/21T00:55:00<span class="p">|</span><span class="m">16766</span>.00<span class="p">|</span>in
--snip--

$ rwcount --bin-size<span class="o">=</span><span class="m">300</span> --no-titles --delimited httpsout.bin<span class="p">|</span>awk -F<span class="se">\|</span> <span class="s1">&#39;{printf(&quot;%s|%s|out\n&quot;, $1, $3)}&#39;</span> &gt; <span class="m">2</span>-btm.txt
--snip--
<span class="m">2015</span>/07/21T00:00:00<span class="p">|</span><span class="m">60615</span>.00<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:05:00<span class="p">|</span><span class="m">317387</span>.87<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:10:00<span class="p">|</span><span class="m">214138</span>.13<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:15:00<span class="p">|</span><span class="m">60527</span>.00<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:20:00<span class="p">|</span><span class="m">3500</span>.00<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:25:00<span class="p">|</span><span class="m">76385</span>.00<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:30:00<span class="p">|</span><span class="m">77113</span>.44<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:35:00<span class="p">|</span><span class="m">32326</span>.56<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:40:00<span class="p">|</span><span class="m">39375</span>.58<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:45:00<span class="p">|</span><span class="m">96888</span>.67<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:50:00<span class="p">|</span><span class="m">30598</span>.75<span class="p">|</span>out
<span class="m">2015</span>/07/21T00:55:00<span class="p">|</span><span class="m">313460</span>.00<span class="p">|</span>out
--snip--
</pre></div>


<p>We graph the values with <code>rwtimeseries</code>. As expected, the incoming traffic is less than the outgoing <span class="caps">HTTPS</span> response. We adjusted the scale of the second and third graph using <code>log</code>, and the last Rayon graph describes data between the 95 and 100&nbsp;percentiles.</p>
<div class="highlight"><pre><span></span>$ cat <span class="m">2</span>-top.txt <span class="m">2</span>-btm.txt <span class="p">|</span> rytimeseries --style<span class="o">=</span>filled_lines --output-path<span class="o">=</span><span class="m">2</span>.png --top-filter<span class="o">=</span><span class="s2">&quot;[2]==in&quot;</span> --bottom-filter<span class="o">=</span><span class="s2">&quot;[2]==out&quot;</span> --top-column<span class="o">=</span><span class="m">1</span> --bottom-column<span class="o">=</span><span class="m">1</span> --annotate-max --value-tick-label-format<span class="o">=</span>metric --value-units<span class="o">=</span>B --title<span class="o">=</span><span class="s2">&quot;Traffic to/from Web Servers&quot;</span> --value-scale<span class="o">=</span>linear
</pre></div>


<p><a href="/assets/linear-rayon-graph.png"><img alt="linear-rayon-graph" src="/assets/linear-rayon-graph.png"></a></p>
<div class="highlight"><pre><span></span>$ cat <span class="m">2</span>-top.txt <span class="m">2</span>-btm.txt <span class="p">|</span> rytimeseries --style<span class="o">=</span>filled_lines --output-path<span class="o">=</span><span class="m">2</span>.png --top-filter<span class="o">=</span><span class="s2">&quot;[2]==in&quot;</span> --bottom-filter<span class="o">=</span><span class="s2">&quot;[2]==out&quot;</span> --top-column<span class="o">=</span><span class="m">1</span> --bottom-column<span class="o">=</span><span class="m">1</span> --annotate-max --value-tick-label-format<span class="o">=</span>metric --value-units<span class="o">=</span>B --title<span class="o">=</span><span class="s2">&quot;Traffic to/from Web Servers&quot;</span> --value-scale<span class="o">=</span>log --<span class="sb">`</span>fix-scale-min<span class="o">=</span><span class="m">1</span>
</pre></div>


<p><a href="/assets/log-rayon-graph.png"><img alt="log-rayon-graph" src="/assets/log-rayon-graph.png"></a></p>
<div class="highlight"><pre><span></span>$ cat <span class="m">2</span>-top.txt <span class="m">2</span>-btm.txt <span class="p">|</span> rytimeseries --style<span class="o">=</span>filled_lines --output-path<span class="o">=</span><span class="m">2</span>.png --top-filter<span class="o">=</span><span class="s2">&quot;[2]==in&quot;</span> --bottom-filter<span class="o">=</span><span class="s2">&quot;[2]==out&quot;</span> --top-column<span class="o">=</span><span class="m">1</span> --bottom-column<span class="o">=</span><span class="m">1</span> --annotate-max --value-tick-label-format<span class="o">=</span>metric --value-units<span class="o">=</span>B --title<span class="o">=</span><span class="s2">&quot;Traffic to/from Web Servers&quot;</span> --value-scale<span class="o">=</span>clog
</pre></div>


<p><a href="/assets/clog-rayon-graph.png"><img alt="clog-rayon-graph" src="/assets/clog-rayon-graph.png"></a></p>
<div class="highlight"><pre><span></span>$ cat <span class="m">2</span>-top.txt <span class="m">2</span>-btm.txt <span class="p">|</span> rytimeseries --style<span class="o">=</span>filled_lines --output-path<span class="o">=</span><span class="m">2</span>.png --top-filter<span class="o">=</span><span class="s2">&quot;[2]==in&quot;</span> --bottom-filter<span class="o">=</span><span class="s2">&quot;[2]==out&quot;</span> --top-column<span class="o">=</span><span class="m">1</span> --bottom-column<span class="o">=</span><span class="m">1</span> --annotate-max --value-tick-label-format<span class="o">=</span>metric --value-units<span class="o">=</span>B --title<span class="o">=</span><span class="s2">&quot;Traffic to/from Web Servers&quot;</span> --value-scale<span class="o">=</span>linear --value-min-pct<span class="o">=</span><span class="m">90</span> --value-max-pct<span class="o">=</span><span class="m">95</span>
</pre></div>


<p><a href="/assets/percentile-rayon-graph.png"><img alt="percentile-rayon-graph" src="/assets/percentile-rayon-graph.png"></a></p>
<p>There you go. A quick and dirty way to identify traffic surges to whatever services you have sitting behind your collector. Please leave any questions you have regarding this post&nbsp;below.</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'rsreese'; // required: replace example with your forum shortname

                    var disqus_identifier = 'silk-network-traffic-analysis-visualization-with-r-and-rayon';
                var disqus_url = 'https://www.rsreese.com/silk-network-traffic-analysis-visualization-with-r-and-rayon/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Stephen Reese
            &middot; Powered by <a href="/web-stack/">Web Stack</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rsreese'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics Universal -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-495000-2', 'auto', {'siteSpeedSampleRate': 25});
        ga('send', 'pageview');
    </script>
    <!-- End Google Analytics Universal Code -->
</body>
</html>